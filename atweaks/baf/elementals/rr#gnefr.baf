IF
Global("RR#Active","LOCALS",0)
!Allegiance(Myself,GOODCUTOFF)
OR(8)
AttackedBy([ANYONE],DEFAULT)
TookDamage()
Heard([EVILCUTOFF.0.147.194],89) // Dao
Heard([EVILCUTOFF.0.147.195],89) // Efreeti
Heard([EVILCUTOFF.0.147.197],89) // Noble Efreeti
Heard([EVILCUTOFF.0.145.187],89) // Elemental of Fire and Salamander
Heard([EVILCUTOFF.0.145.187],151)// Elemental of Fire and Salamander
Heard([EVILCUTOFF.0.105],89) 	 // Hell Hounds
THEN
RESPONSE #100
SetGlobal("RR#Active","LOCALS",1)
SetGlobalTimer("RR#Rest","LOCALS",2400) // 8 hours
SetGlobalTimer("RR#Help","LOCALS",18)
Enemy()
Shout(89)
END

IF
Global("RR#Active","LOCALS",0)
Allegiance(Myself,EVILCUTOFF)
OR(3)
See([GOODCUTOFF]) // this cannot be in the previous block, otherwise neutral creatures would go hostile upon seeing a party member
See([EVILCUTOFF.0.147.193]) // Djinn
See([EVILCUTOFF.0.147.196]) // Noble Djinn
THEN
RESPONSE #100
SetGlobal("RR#Active","LOCALS",1)
SetGlobalTimer("RR#Rest","LOCALS",2400) // 8 hours
SetGlobalTimer("RR#Help","LOCALS",18)
Enemy()
Shout(89)
END

IF
	!GlobalTimerNotExpired("RR#Help","LOCALS") // shout for help every three rounds while in combat, others may hear it and join the battle
	Allegiance(Myself,EVILCUTOFF)
	See([GOODCUTOFF])
THEN
	RESPONSE #100
		SetGlobalTimer("RR#Help","LOCALS",18)
		Shout(89)
		Continue()
END

IF
!Detect(NearestEnemyOf(Myself))
Global("RR#Rest","LOCALS",1)
!GlobalTimerNotExpired("RR#RestTimer","LOCALS")
THEN
RESPONSE #100
SetGlobal("RR#Rest","LOCALS",0)
ApplySpell(Myself,RESTORE_FULL_HEALTH)
Rest()
END

IF
!GlobalTimerNotExpired("RR#RestTimer","LOCALS")
Detect(NearestEnemyOf(Myself))
Global("RR#Rest","LOCALS",0)
THEN
RESPONSE #100
SetGlobalTimer("RR#RestTimer","LOCALS",2400)
SetGlobal("RR#Rest","LOCALS",1)
Continue()
END

IF
Global("RR#Active","LOCALS",0)
HitBy([GOODCUTOFF],0)
!Allegiance(Myself,GOODCUTOFF)
THEN
RESPONSE #100
SetGlobal("RR#Active","LOCALS",1)
Enemy()
Continue()
END

IF
Global("RR#Active","LOCALS",0)
Allegiance(Myself,EVILCUTOFF)
See([GOODCUTOFF])
THEN
RESPONSE #100
SetGlobal("RR#Active","LOCALS",1)
Continue()
END

IF
OR(13)
HitBy([GOODCUTOFF],0)
AttackedBy([GOODCUTOFF.0.0.0.0.SUMMONED],DEFAULT)
AttackedBy([PC],DEFAULT)
AttackedBy([FAMILIAR],DEFAULT)
AttackedBy([ALLY],DEFAULT)
AttackedBy([CONTROLLED],DEFAULT)
AttackedBy([CHARMED],DEFAULT)
SpellCastOnMe([GOODCUTOFF.0.0.0.0.SUMMONED],0)
SpellCastOnMe([PC],0)
SpellCastOnMe([FAMILIAR],0)
SpellCastOnMe([ALLY],0)
SpellCastOnMe([CONTROLLED],0)
SpellCastOnMe([CHARMED],0)
!GlobalTimerNotExpired("whatthe","LOCALS")
!See([GOODCUTOFF])
THEN
RESPONSE #100
Enemy()
SetGlobalTimer("whatthe","LOCALS",12)
Continue()
END

IF
!See([GOODCUTOFF])
GlobalTimerNotExpired("whatthe","LOCALS")
THEN
RESPONSE #100
RandomWalkContinuous()
END

IF
See([GOODCUTOFF])
GlobalTimerNotExpired("whatthe","LOCALS")
THEN
RESPONSE #100
ClearActions(Myself)
SetGlobalTimer("whatthe","LOCALS",0)
END

IF
Allegiance(Myself,EVILCUTOFF)
Global("RR#Active","LOCALS",0)
!Detect(NearestEnemyOf(Myself))
THEN
RESPONSE #100
NoAction()
END

IF
StateCheck(Myself,STATE_PANIC)
THEN
RESPONSE #100
RandomWalkContinuous()
END

IF
StateCheck(Myself,STATE_CHARMED)
See(NearestEnemyOf(Myself))
ActionListEmpty()
!Range(LastSeenBy(Myself),5)
THEN
RESPONSE #100
MoveToObject(LastSeenBy(Myself))
END

IF
StateCheck(Myself,STATE_CHARMED)
See(NearestEnemyOf(Myself))
ActionListEmpty()
Range(LastSeenBy(Myself),5)
THEN
RESPONSE #100
Attack(LastSeenBy(Myself))
END

IF
	Global("RR#Gform","LOCALS",1)
	!HasItemEquiped("RR#Gform",Myself)
THEN
	RESPONSE #100
		IncrementGlobal("RR#Gform","LOCALS",2)
		NoAction()
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	Global("RR#Gform","LOCALS",0)
	HPPercentLT(Myself,15)
THEN
	RESPONSE #100
		SetGlobalTimer("RR#Cast","LOCALS",ONE_ROUND)
		IncrementGlobal("RR#Gform","LOCALS",1)
		ForceSpellRES("RR#gmsgf",Myself)  // Gaseous Form
END

IF
	Global("RR#Gform","LOCALS",1)
THEN
	RESPONSE #100
	RandomWalk()
END

IF
	Global("RR#Active","LOCALS",1)
    Global("RR#START","LOCALS",0)
THEN
	RESPONSE #100
        SetInterrupt(FALSE)
		SetGlobal("RR#START","LOCALS",1)
		ReallyForceSpellRES("rr#gr606",Myself) // fire seeds
        RemoveSpellRES("rr#gr606") // remove one instance of the spell upon casting
		ReallyForceSpellRES("rr#gi212",Myself) // Mirror Image
        RemoveSpellRES("rr#gi212") // remove one instance of the spell upon casting
        ReallyForceSpellRES("rr#gi418",Myself) // Fire Shield:Red
        RemoveSpellRES("rr#gi418") // remove one instance of the spell upon casting
        SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	HaveSpellRES("rr#gi212") // Mirror Image
	Detect([GOODCUTOFF])
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	!CheckStatGT(Player1,0,TRUE_SIGHT)
	!CheckStatGT(Player2,0,TRUE_SIGHT)
	!CheckStatGT(Player3,0,TRUE_SIGHT)
	!CheckStatGT(Player4,0,TRUE_SIGHT)
	!CheckStatGT(Player5,0,TRUE_SIGHT)
	!CheckStatGT(Player6,0,TRUE_SIGHT)
	!CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
	!CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
	RESPONSE #100
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SpellRES("rr#gi212",Myself) // Mirror Image
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	!GlobalTimerNotExpired("RR#wall_fire","LOCALS")
	HaveSpellRES("rr#gwalf") // Wall of Fire
    Range(NearestEnemyOf(Myself),10)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
THEN
	RESPONSE #100
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SetGlobalTimer("RR#wall_fire","LOCALS",24)
        SpellRES("rr#gwalf",LastSeenBy(Myself)) // Wall of Fire
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	!GlobalTimerNotExpired("RR#wall_fire","LOCALS")
	HaveSpellRES("rr#gwalf") // Wall of Fire
    Range(SecondNearestEnemyOf(Myself),10)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
THEN
	RESPONSE #100
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SetGlobalTimer("RR#wall_fire","LOCALS",24)
        SpellRES("rr#gwalf",LastSeenBy(Myself)) // Wall of Fire
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	!GlobalTimerNotExpired("RR#wall_fire","LOCALS")
	HaveSpellRES("rr#gwalf") // Wall of Fire
    Range(ThirdNearestEnemyOf(Myself),10)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
THEN
	RESPONSE #100
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SetGlobalTimer("RR#wall_fire","LOCALS",24)
        SpellRES("rr#gwalf",LastSeenBy(Myself)) // Wall of Fire
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	!GlobalTimerNotExpired("RR#pyren","LOCALS")
    HaveSpellRES("rr#pyren") // pyrotechnics
	See([PC.0.0.FIGHTER_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Alteration
	!HasItemEquiped("MISC73",LastSeenBy(Myself)) // The Horn of Kazgaroth
	!Check%State%(LastSeenBy(Myself),%Num%ITEM_BLIND)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SetGlobalTimer("RR#pyren","LOCALS",30)
		SpellRES("rr#pyren",LastSeenBy(Myself)) // pyrotechnics
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	!GlobalTimerNotExpired("RR#pyren","LOCALS")
    HaveSpellRES("rr#pyren") // pyrotechnics
	See([PC.0.0.RANGER_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Alteration
	!HasItemEquiped("MISC73",LastSeenBy(Myself)) // The Horn of Kazgaroth
	!Check%State%(LastSeenBy(Myself),%Num%ITEM_BLIND)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SetGlobalTimer("RR#pyren","LOCALS",30)
		SpellRES("rr#pyren",LastSeenBy(Myself)) // pyrotechnics
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	!GlobalTimerNotExpired("RR#pyren","LOCALS")
    HaveSpellRES("rr#pyren") // pyrotechnics
	See([PC.0.0.PALADIN_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Alteration
	!HasItemEquiped("MISC73",LastSeenBy(Myself)) // The Horn of Kazgaroth
	!Check%State%(LastSeenBy(Myself),%Num%ITEM_BLIND)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SetGlobalTimer("RR#pyren","LOCALS",30)
		SpellRES("rr#pyren",LastSeenBy(Myself)) // pyrotechnics
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	!GlobalTimerNotExpired("RR#pyren","LOCALS")
    HaveSpellRES("rr#pyren") // pyrotechnics
	See(StrongestOf([PC]))
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Alteration
	!HasItemEquiped("MISC73",LastSeenBy(Myself)) // The Horn of Kazgaroth
	!Check%State%(LastSeenBy(Myself),%Num%ITEM_BLIND)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SetGlobalTimer("RR#pyren","LOCALS",30)
		SpellRES("rr#pyren",LastSeenBy(Myself)) // pyrotechnics
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("RR#Cast","LOCALS")
	!GlobalTimerNotExpired("RR#pyren","LOCALS")
    HaveSpellRES("rr#pyren") // pyrotechnics
	See(LastAttackerOf(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Alteration
	!HasItemEquiped("MISC73",LastSeenBy(Myself)) // The Horn of Kazgaroth
	!Check%State%(LastSeenBy(Myself),%Num%ITEM_BLIND)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("RR#Cast","LOCALS",6)
		SetGlobalTimer("RR#pyren","LOCALS",30)
		SpellRES("rr#pyren",LastSeenBy(Myself)) // pyrotechnics
		SetInterrupt(TRUE)
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See([PC.0.0.MAGE_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #60
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
    RESPONSE #20
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See([PC.0.0.BARD_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #60
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
    RESPONSE #20
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See([PC.0.0.THIEF_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #15
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #55
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
    RESPONSE #30
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See([PC.0.0.DRUID_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #15
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #55
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
    RESPONSE #30
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See([PC.0.0.CLERIC_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #15
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #55
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
    RESPONSE #30
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	See([PC])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #80
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See(SixthNearestEnemyOf(Myself))
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #80
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See(FifthNearestEnemyOf(Myself))
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #80
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See(FourthNearestEnemyOf(Myself))
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #80
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See(ThirdNearestEnemyOf(Myself))
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #80
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See(SecondNearestEnemyOf(Myself))
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #80
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
    See(NearestEnemyOf(Myself))
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("shld24",LastSeenBy(Myself)) // Reflection Shield
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #20
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #80
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gi303",LastSeenBy(Myself)) // Flame Arrow
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See([PC.0.0.MAGE_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #75
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #25
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See([PC.0.0.BARD_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #75
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #25
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See([PC.0.0.THIEF_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #70
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #30
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See([PC.0.0.DRUID_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #70
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #30
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See([PC.0.0.CLERIC_ALL])
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #70
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
    RESPONSE #30
		Continue()
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See(SixthNearestEnemyOf(Myself))
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #100
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See(FifthNearestEnemyOf(Myself))
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #100
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See(FourthNearestEnemyOf(Myself))
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #100
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See(ThirdNearestEnemyOf(Myself))
    !Range(LastSeenBy(Myself),5)
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #100
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
    See(SecondNearestEnemyOf(Myself))
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #100
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
END

IF
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    !GlobalTimerNotExpired("RR#flame","LOCALS")
	!HasItemEquipedReal("FIRESEED",Myself)
	HaveSpellRES("rr#gpfla") // Produce Flame
	See([PC])
    !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
    !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
    !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
    CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
    CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
    !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
    !CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) // Spell Immunity: Evocation
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
THEN
    RESPONSE #100
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SetGlobalTimer("RR#flame","LOCALS",12)
        SpellRES("rr#gpfla",LastSeenBy(Myself)) // Produce Flame
END

IF
See([PC.0.0.MAGE_ALL])
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.BARD_ALL])
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.THIEF_ALL])
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
RESPONSE #30
Continue()
END

IF
See([PC.0.0.DRUID_ALL])
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
RESPONSE #30
Continue()
END

IF
See([PC.0.0.CLERIC_ALL])
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
RESPONSE #30
Continue()
END

IF
See([PC])
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
END

IF
See(NearestEnemyOf(Myself))
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
END

IF
See(SecondNearestEnemyOf(Myself))
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
END

IF
See(ThirdNearestEnemyOf(Myself))
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
END

IF
See(FourthNearestEnemyOf(Myself))
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
END

IF
See(FifthNearestEnemyOf(Myself))
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
END

IF
See(SixthNearestEnemyOf(Myself))
HasItemEquipedReal("FIRESEED",Myself)
InWeaponRange(LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
END

IF
	OR(7)
		ActionListEmpty()
		SpellCastOnMe([GOODCUTOFF.0.0.0.0.SUMMONED],0)
		SpellCastOnMe([PC],0)
		SpellCastOnMe([FAMILIAR],0)
		SpellCastOnMe([ALLY],0)
		SpellCastOnMe([CONTROLLED],0)
		SpellCastOnMe([CHARMED],0)
    !GlobalTimerNotExpired("RR#Cast","LOCALS")
    HaveSpellRES("rr#gi206") // invisibility
	Allegiance(Myself,EVILCUTOFF)
	Detect([GOODCUTOFF])
    !StateCheck(Myself,STATE_INVISIBLE)
    !Global("dvgldust","LOCALS",1)
	!Global("LCNOINVI","LOCALS",1)
    !CheckStatGT([GOODCUTOFF],0,SEEINVISIBLE)
    !CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(SeventhNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(EighthNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(NinthNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT(TenthNearestEnemyOf(Myself),0,TRUE_SIGHT)
    !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
    !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
    RESPONSE #100
        SetInterrupt(FALSE)
        SetGlobalTimer("RR#Cast","LOCALS",6)
        SpellRES("rr#gi206",Myself) // invisibility
        RemoveSpellRES("rr#gi206") // remove one instance of the spell upon casting
        SetInterrupt(TRUE)
END

IF
See([PC.0.0.MAGE])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE])
CheckStatLT([PC.0.0.MAGE],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE],0,STONESKINS)
!StateCheck([PC.0.0.MAGE],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE],0,HELD)
!StateCheck([PC.0.0.MAGE],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE],25)
Range([PC.0.0.MAGE],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_THIEF])
CheckStatLT([PC.0.0.MAGE_THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,HELD)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_THIEF],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE_THIEF],25)
Range([PC.0.0.MAGE_THIEF],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE_THIEF],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_ALL])
CheckStatLT([PC.0.0.MAGE_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_ALL],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_ALL],0,HELD)
!StateCheck([PC.0.0.MAGE_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE_ALL],25)
Range([PC.0.0.MAGE_ALL],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE_ALL],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF])
CheckStatLT([PC.0.0.THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF],0,STONESKINS)
!StateCheck([PC.0.0.THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF],0,HELD)
!StateCheck([PC.0.0.THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF],EVILCUTOFF)
!HPPercentGT([PC.0.0.THIEF],25)
Range([PC.0.0.THIEF],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.THIEF],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.BARD_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.BARD_ALL])
CheckStatLT([PC.0.0.BARD_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.BARD_ALL],0,STONESKINS)
!StateCheck([PC.0.0.BARD_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.BARD_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.BARD_ALL],0,HELD)
!StateCheck([PC.0.0.BARD_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.BARD_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.BARD_ALL],25)
Range([PC.0.0.BARD_ALL],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.BARD_ALL],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.THIEF_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF_ALL])
CheckStatLT([PC.0.0.THIEF_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF_ALL],0,STONESKINS)
!StateCheck([PC.0.0.THIEF_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF_ALL],0,HELD)
!StateCheck([PC.0.0.THIEF_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.THIEF_ALL],25)
Range([PC.0.0.THIEF_ALL],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.THIEF_ALL],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.DRUID])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.DRUID],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.DRUID])
CheckStatLT([PC.0.0.DRUID],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.DRUID],0,STONESKINS)
!StateCheck([PC.0.0.DRUID],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.DRUID],STATE_DISABLED)
!CheckStatGT([PC.0.0.DRUID],0,HELD)
!StateCheck([PC.0.0.DRUID],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.DRUID],EVILCUTOFF)
!HPPercentGT([PC.0.0.DRUID],25)
Range([PC.0.0.DRUID],5)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.DRUID],30)
RESPONSE #30
Continue()
END

IF
See([PC.0.0.CLERIC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.CLERIC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.CLERIC])
CheckStatLT([PC.0.0.CLERIC],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.CLERIC],0,STONESKINS)
!StateCheck([PC.0.0.CLERIC],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.CLERIC],STATE_DISABLED)
!CheckStatGT([PC.0.0.CLERIC],0,HELD)
!StateCheck([PC.0.0.CLERIC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.CLERIC],EVILCUTOFF)
!HPPercentGT([PC.0.0.CLERIC],25)
Range([PC.0.0.CLERIC],5)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.CLERIC],30)
RESPONSE #30
Continue()
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
!StateCheck([PC],STATE_MIRRORIMAGE)
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
!HPPercentGT([PC],25)
Range([PC],5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
!StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
!HPPercentGT(SecondNearest([PC]),25)
Range(SecondNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
!StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
!HPPercentGT(ThirdNearest([PC]),25)
Range(ThirdNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
CheckStatLT(NearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(NearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(NearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(NearestEnemyOf(Myself),25)
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(NearestEnemyOf(Myself),15)
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
CheckStatLT(SecondNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(SecondNearestEnemyOf(Myself),25)
Range(SecondNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearestEnemyOf(Myself),15)
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
CheckStatLT(ThirdNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(ThirdNearestEnemyOf(Myself),25)
Range(ThirdNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearestEnemyOf(Myself),15)
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
CheckStatLT(FourthNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(FourthNearestEnemyOf(Myself),25)
Range(FourthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearestEnemyOf(Myself),15)
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
CheckStatLT(FifthNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(FifthNearestEnemyOf(Myself),25)
Range(FifthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearestEnemyOf(Myself),15)
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
CheckStatLT(SixthNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(SixthNearestEnemyOf(Myself),25)
Range(SixthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearestEnemyOf(Myself),15)
END

IF
See([PC.0.0.MAGE])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE])
CheckStatLT([PC.0.0.MAGE],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE],0,STONESKINS)
!StateCheck([PC.0.0.MAGE],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE],0,HELD)
!StateCheck([PC.0.0.MAGE],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE],25)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE])
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_THIEF])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_THIEF])
CheckStatLT([PC.0.0.MAGE_THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,HELD)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_THIEF],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE_THIEF],25)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE_THIEF])
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_ALL])
CheckStatLT([PC.0.0.MAGE_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_ALL],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_ALL],0,HELD)
!StateCheck([PC.0.0.MAGE_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE_ALL],25)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE_ALL])
RESPONSE #25
Continue()
END

IF
See([PC.0.0.THIEF])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF])
CheckStatLT([PC.0.0.THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF],0,STONESKINS)
!StateCheck([PC.0.0.THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF],0,HELD)
!StateCheck([PC.0.0.THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF],EVILCUTOFF)
!HPPercentGT([PC.0.0.THIEF],25)
THEN
RESPONSE #65
MoveToObject([PC.0.0.THIEF])
RESPONSE #35
Continue()
END

IF
See([PC.0.0.BARD_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.BARD_ALL])
CheckStatLT([PC.0.0.BARD_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.BARD_ALL],0,STONESKINS)
!StateCheck([PC.0.0.BARD_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.BARD_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.BARD_ALL],0,HELD)
!StateCheck([PC.0.0.BARD_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.BARD_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.BARD_ALL],25)
THEN
RESPONSE #65
MoveToObject([PC.0.0.BARD_ALL])
RESPONSE #35
Continue()
END

IF
See([PC.0.0.THIEF_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF_ALL])
CheckStatLT([PC.0.0.THIEF_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF_ALL],0,STONESKINS)
!StateCheck([PC.0.0.THIEF_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF_ALL],0,HELD)
!StateCheck([PC.0.0.THIEF_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.THIEF_ALL],25)
THEN
RESPONSE #65
MoveToObject([PC.0.0.THIEF_ALL])
RESPONSE #35
Continue()
END

IF
See([PC.0.0.DRUID])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.DRUID],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.DRUID])
CheckStatLT([PC.0.0.DRUID],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.DRUID],0,STONESKINS)
!StateCheck([PC.0.0.DRUID],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.DRUID],STATE_DISABLED)
!CheckStatGT([PC.0.0.DRUID],0,HELD)
!StateCheck([PC.0.0.DRUID],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.DRUID],EVILCUTOFF)
!HPPercentGT([PC.0.0.DRUID],25)
THEN
RESPONSE #70
MoveToObject([PC.0.0.DRUID])
RESPONSE #30
Continue()
END

IF
See([PC.0.0.CLERIC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.CLERIC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.CLERIC])
CheckStatLT([PC.0.0.CLERIC],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.CLERIC],0,STONESKINS)
!StateCheck([PC.0.0.CLERIC],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.CLERIC],STATE_DISABLED)
!CheckStatGT([PC.0.0.CLERIC],0,HELD)
!StateCheck([PC.0.0.CLERIC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.CLERIC],EVILCUTOFF)
!HPPercentGT([PC.0.0.CLERIC],25)
THEN
RESPONSE #70
MoveToObject([PC.0.0.CLERIC])
RESPONSE #30
Continue()
END

IF
See([PC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
!StateCheck([PC],STATE_MIRRORIMAGE)
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
!HPPercentGT([PC],25)
THEN
RESPONSE #100
MoveToObject([PC])
END

IF
See(SecondNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
!StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
!HPPercentGT(SecondNearest([PC]),25)
THEN
RESPONSE #100
MoveToObject(SecondNearest([PC]))
END

IF
See(ThirdNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
!StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
!HPPercentGT(ThirdNearest([PC]),25)
THEN
RESPONSE #100
MoveToObject(ThirdNearest([PC]))
END

IF
See([PC.0.0.MAGE])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE])
CheckStatLT([PC.0.0.MAGE],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE],0,STONESKINS)
!StateCheck([PC.0.0.MAGE],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE],0,HELD)
!StateCheck([PC.0.0.MAGE],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE],50)
Range([PC.0.0.MAGE],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_THIEF])
CheckStatLT([PC.0.0.MAGE_THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,HELD)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_THIEF],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE_THIEF],50)
Range([PC.0.0.MAGE_THIEF],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE_THIEF],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_ALL])
CheckStatLT([PC.0.0.MAGE_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_ALL],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_ALL],0,HELD)
!StateCheck([PC.0.0.MAGE_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE_ALL],50)
Range([PC.0.0.MAGE_ALL],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE_ALL],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF])
CheckStatLT([PC.0.0.THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF],0,STONESKINS)
!StateCheck([PC.0.0.THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF],0,HELD)
!StateCheck([PC.0.0.THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF],EVILCUTOFF)
!HPPercentGT([PC.0.0.THIEF],50)
Range([PC.0.0.THIEF],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.THIEF],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.BARD_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.BARD_ALL])
CheckStatLT([PC.0.0.BARD_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.BARD_ALL],0,STONESKINS)
!StateCheck([PC.0.0.BARD_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.BARD_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.BARD_ALL],0,HELD)
!StateCheck([PC.0.0.BARD_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.BARD_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.BARD_ALL],50)
Range([PC.0.0.BARD_ALL],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.BARD_ALL],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.THIEF_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF_ALL])
CheckStatLT([PC.0.0.THIEF_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF_ALL],0,STONESKINS)
!StateCheck([PC.0.0.THIEF_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF_ALL],0,HELD)
!StateCheck([PC.0.0.THIEF_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.THIEF_ALL],50)
Range([PC.0.0.THIEF_ALL],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.THIEF_ALL],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.DRUID])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.DRUID],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.DRUID])
CheckStatLT([PC.0.0.DRUID],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.DRUID],0,STONESKINS)
!StateCheck([PC.0.0.DRUID],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.DRUID],STATE_DISABLED)
!CheckStatGT([PC.0.0.DRUID],0,HELD)
!StateCheck([PC.0.0.DRUID],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.DRUID],EVILCUTOFF)
!HPPercentGT([PC.0.0.DRUID],50)
Range([PC.0.0.DRUID],5)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.DRUID],30)
RESPONSE #30
Continue()
END

IF
See([PC.0.0.CLERIC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.CLERIC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.CLERIC])
CheckStatLT([PC.0.0.CLERIC],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.CLERIC],0,STONESKINS)
!StateCheck([PC.0.0.CLERIC],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.CLERIC],STATE_DISABLED)
!CheckStatGT([PC.0.0.CLERIC],0,HELD)
!StateCheck([PC.0.0.CLERIC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.CLERIC],EVILCUTOFF)
!HPPercentGT([PC.0.0.CLERIC],50)
Range([PC.0.0.CLERIC],5)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.CLERIC],30)
RESPONSE #30
Continue()
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
!StateCheck([PC],STATE_MIRRORIMAGE)
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
!HPPercentGT([PC],50)
Range([PC],5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
!StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
!HPPercentGT(SecondNearest([PC]),50)
Range(SecondNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
!StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
!HPPercentGT(ThirdNearest([PC]),50)
Range(ThirdNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
CheckStatLT(NearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(NearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(NearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(NearestEnemyOf(Myself),50)
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(NearestEnemyOf(Myself),15)
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
CheckStatLT(SecondNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(SecondNearestEnemyOf(Myself),50)
Range(SecondNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearestEnemyOf(Myself),15)
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
CheckStatLT(ThirdNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(ThirdNearestEnemyOf(Myself),50)
Range(ThirdNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearestEnemyOf(Myself),15)
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
CheckStatLT(FourthNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(FourthNearestEnemyOf(Myself),50)
Range(FourthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearestEnemyOf(Myself),15)
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
CheckStatLT(FifthNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(FifthNearestEnemyOf(Myself),50)
Range(FifthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearestEnemyOf(Myself),15)
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
CheckStatLT(SixthNearestEnemyOf(Myself),50,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearestEnemyOf(Myself),EVILCUTOFF)
!HPPercentGT(SixthNearestEnemyOf(Myself),50)
Range(SixthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearestEnemyOf(Myself),15)
END

IF
ActionListEmpty()
See([PC.0.0.MAGE])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE])
CheckStatLT([PC.0.0.MAGE],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE],0,STONESKINS)
!StateCheck([PC.0.0.MAGE],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE],0,HELD)
!StateCheck([PC.0.0.MAGE],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE],50)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE])
RESPONSE #25
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.MAGE_THIEF])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_THIEF])
CheckStatLT([PC.0.0.MAGE_THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,HELD)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_THIEF],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE_THIEF],50)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE_THIEF])
RESPONSE #25
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.MAGE_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_ALL])
CheckStatLT([PC.0.0.MAGE_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_ALL],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_ALL],0,HELD)
!StateCheck([PC.0.0.MAGE_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.MAGE_ALL],50)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE_ALL])
RESPONSE #25
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.THIEF])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF])
CheckStatLT([PC.0.0.THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF],0,STONESKINS)
!StateCheck([PC.0.0.THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF],0,HELD)
!StateCheck([PC.0.0.THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF],EVILCUTOFF)
!HPPercentGT([PC.0.0.THIEF],50)
THEN
RESPONSE #65
MoveToObject([PC.0.0.THIEF])
RESPONSE #35
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.BARD_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.BARD_ALL])
CheckStatLT([PC.0.0.BARD_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.BARD_ALL],0,STONESKINS)
!StateCheck([PC.0.0.BARD_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.BARD_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.BARD_ALL],0,HELD)
!StateCheck([PC.0.0.BARD_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.BARD_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.BARD_ALL],50)
THEN
RESPONSE #65
MoveToObject([PC.0.0.BARD_ALL])
RESPONSE #35
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.THIEF_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF_ALL])
CheckStatLT([PC.0.0.THIEF_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF_ALL],0,STONESKINS)
!StateCheck([PC.0.0.THIEF_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF_ALL],0,HELD)
!StateCheck([PC.0.0.THIEF_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF_ALL],EVILCUTOFF)
!HPPercentGT([PC.0.0.THIEF_ALL],50)
THEN
RESPONSE #65
MoveToObject([PC.0.0.THIEF_ALL])
RESPONSE #35
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.DRUID])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.DRUID],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.DRUID])
CheckStatLT([PC.0.0.DRUID],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.DRUID],0,STONESKINS)
!StateCheck([PC.0.0.DRUID],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.DRUID],STATE_DISABLED)
!CheckStatGT([PC.0.0.DRUID],0,HELD)
!StateCheck([PC.0.0.DRUID],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.DRUID],EVILCUTOFF)
!HPPercentGT([PC.0.0.DRUID],50)
THEN
RESPONSE #70
MoveToObject([PC.0.0.DRUID])
RESPONSE #30
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.CLERIC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.CLERIC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.CLERIC])
CheckStatLT([PC.0.0.CLERIC],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.CLERIC],0,STONESKINS)
!StateCheck([PC.0.0.CLERIC],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.CLERIC],STATE_DISABLED)
!CheckStatGT([PC.0.0.CLERIC],0,HELD)
!StateCheck([PC.0.0.CLERIC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.CLERIC],EVILCUTOFF)
!HPPercentGT([PC.0.0.CLERIC],50)
THEN
RESPONSE #70
MoveToObject([PC.0.0.CLERIC])
RESPONSE #30
Continue()
END

IF
ActionListEmpty()
See([PC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
!StateCheck([PC],STATE_MIRRORIMAGE)
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
!HPPercentGT([PC],50)
THEN
RESPONSE #100
MoveToObject([PC])
END

IF
ActionListEmpty()
See(SecondNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
!StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
!HPPercentGT(SecondNearest([PC]),50)
THEN
RESPONSE #100
MoveToObject(SecondNearest([PC]))
END

IF
ActionListEmpty()
See(ThirdNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
!StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
!HPPercentGT(ThirdNearest([PC]),50)
THEN
RESPONSE #100
MoveToObject(ThirdNearest([PC]))
END

IF
See([PC.0.0.MAGE])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE])
CheckStatLT([PC.0.0.MAGE],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE],0,STONESKINS)
!StateCheck([PC.0.0.MAGE],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE],0,HELD)
!StateCheck([PC.0.0.MAGE],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE],EVILCUTOFF)
Range([PC.0.0.MAGE],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_THIEF])
CheckStatLT([PC.0.0.MAGE_THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,HELD)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_THIEF],EVILCUTOFF)
Range([PC.0.0.MAGE_THIEF],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE_THIEF],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_ALL])
CheckStatLT([PC.0.0.MAGE_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_ALL],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_ALL],0,HELD)
!StateCheck([PC.0.0.MAGE_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_ALL],EVILCUTOFF)
Range([PC.0.0.MAGE_ALL],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE_ALL],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF])
CheckStatLT([PC.0.0.THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF],0,STONESKINS)
!StateCheck([PC.0.0.THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF],0,HELD)
!StateCheck([PC.0.0.THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF],EVILCUTOFF)
Range([PC.0.0.THIEF],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.THIEF],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.BARD_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.BARD_ALL])
CheckStatLT([PC.0.0.BARD_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.BARD_ALL],0,STONESKINS)
!StateCheck([PC.0.0.BARD_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.BARD_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.BARD_ALL],0,HELD)
!StateCheck([PC.0.0.BARD_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.BARD_ALL],EVILCUTOFF)
Range([PC.0.0.BARD_ALL],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.BARD_ALL],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.THIEF_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF_ALL])
CheckStatLT([PC.0.0.THIEF_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF_ALL],0,STONESKINS)
!StateCheck([PC.0.0.THIEF_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF_ALL],0,HELD)
!StateCheck([PC.0.0.THIEF_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF_ALL],EVILCUTOFF)
Range([PC.0.0.THIEF_ALL],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.THIEF_ALL],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.DRUID])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.DRUID],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.DRUID])
CheckStatLT([PC.0.0.DRUID],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.DRUID],0,STONESKINS)
!StateCheck([PC.0.0.DRUID],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.DRUID],STATE_DISABLED)
!CheckStatGT([PC.0.0.DRUID],0,HELD)
!StateCheck([PC.0.0.DRUID],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.DRUID],EVILCUTOFF)
Range([PC.0.0.DRUID],5)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.DRUID],30)
RESPONSE #30
Continue()
END

IF
See([PC.0.0.CLERIC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.CLERIC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.CLERIC])
CheckStatLT([PC.0.0.CLERIC],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.CLERIC],0,STONESKINS)
!StateCheck([PC.0.0.CLERIC],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.CLERIC],STATE_DISABLED)
!CheckStatGT([PC.0.0.CLERIC],0,HELD)
!StateCheck([PC.0.0.CLERIC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.CLERIC],EVILCUTOFF)
Range([PC.0.0.CLERIC],5)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.CLERIC],30)
RESPONSE #30
Continue()
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
!StateCheck([PC],STATE_MIRRORIMAGE)
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
Range([PC],5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
!StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
Range(SecondNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
!StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
Range(ThirdNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
ActionListEmpty()
See([PC.0.0.MAGE])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE])
CheckStatLT([PC.0.0.MAGE],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE],0,STONESKINS)
!StateCheck([PC.0.0.MAGE],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE],0,HELD)
!StateCheck([PC.0.0.MAGE],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE],EVILCUTOFF)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE])
RESPONSE #25
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.MAGE_THIEF])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_THIEF])
CheckStatLT([PC.0.0.MAGE_THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_THIEF],0,HELD)
!StateCheck([PC.0.0.MAGE_THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_THIEF],EVILCUTOFF)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE_THIEF])
RESPONSE #25
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.MAGE_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_ALL])
CheckStatLT([PC.0.0.MAGE_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.MAGE_ALL],0,STONESKINS)
!StateCheck([PC.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.MAGE_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.MAGE_ALL],0,HELD)
!StateCheck([PC.0.0.MAGE_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_ALL],EVILCUTOFF)
THEN
RESPONSE #75
MoveToObject([PC.0.0.MAGE_ALL])
RESPONSE #25
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.THIEF])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF])
CheckStatLT([PC.0.0.THIEF],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF],0,STONESKINS)
!StateCheck([PC.0.0.THIEF],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF],0,HELD)
!StateCheck([PC.0.0.THIEF],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF],EVILCUTOFF)
THEN
RESPONSE #65
MoveToObject([PC.0.0.THIEF])
RESPONSE #35
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.BARD_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.BARD_ALL])
CheckStatLT([PC.0.0.BARD_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.BARD_ALL],0,STONESKINS)
!StateCheck([PC.0.0.BARD_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.BARD_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.BARD_ALL],0,HELD)
!StateCheck([PC.0.0.BARD_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.BARD_ALL],EVILCUTOFF)
THEN
RESPONSE #65
MoveToObject([PC.0.0.BARD_ALL])
RESPONSE #35
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.THIEF_ALL])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF_ALL])
CheckStatLT([PC.0.0.THIEF_ALL],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.THIEF_ALL],0,STONESKINS)
!StateCheck([PC.0.0.THIEF_ALL],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.THIEF_ALL],STATE_DISABLED)
!CheckStatGT([PC.0.0.THIEF_ALL],0,HELD)
!StateCheck([PC.0.0.THIEF_ALL],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF_ALL],EVILCUTOFF)
THEN
RESPONSE #65
MoveToObject([PC.0.0.THIEF_ALL])
RESPONSE #35
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.DRUID])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.DRUID],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.DRUID])
CheckStatLT([PC.0.0.DRUID],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.DRUID],0,STONESKINS)
!StateCheck([PC.0.0.DRUID],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.DRUID],STATE_DISABLED)
!CheckStatGT([PC.0.0.DRUID],0,HELD)
!StateCheck([PC.0.0.DRUID],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.DRUID],EVILCUTOFF)
THEN
RESPONSE #70
MoveToObject([PC.0.0.DRUID])
RESPONSE #30
Continue()
END

IF
ActionListEmpty()
See([PC.0.0.CLERIC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.CLERIC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.CLERIC])
CheckStatLT([PC.0.0.CLERIC],50,RESISTSLASHING)
!CheckStatGT([PC.0.0.CLERIC],0,STONESKINS)
!StateCheck([PC.0.0.CLERIC],STATE_MIRRORIMAGE)
!StateCheck([PC.0.0.CLERIC],STATE_DISABLED)
!CheckStatGT([PC.0.0.CLERIC],0,HELD)
!StateCheck([PC.0.0.CLERIC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.CLERIC],EVILCUTOFF)
THEN
RESPONSE #70
MoveToObject([PC.0.0.CLERIC])
RESPONSE #30
Continue()
END

IF
ActionListEmpty()
See([PC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
!StateCheck([PC],STATE_MIRRORIMAGE)
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject([PC])
END

IF
ActionListEmpty()
See(SecondNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
!StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(SecondNearest([PC]))
END

IF
ActionListEmpty()
See(ThirdNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
!StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(ThirdNearest([PC]))
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
!StateCheck([PC],STATE_MIRRORIMAGE)
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
Range([PC],5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
!StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
Range(SecondNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
!StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
Range(ThirdNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
See(FourthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearest([PC]))
CheckStatLT(FourthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(FourthNearest([PC]),0,STONESKINS)
!StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(FourthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FourthNearest([PC]),0,HELD)
!StateCheck(FourthNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearest([PC]),EVILCUTOFF)
Range(FourthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearest([PC]),30)
END

IF
See(FifthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearest([PC]))
CheckStatLT(FifthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(FifthNearest([PC]),0,STONESKINS)
!StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(FifthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FifthNearest([PC]),0,HELD)
!StateCheck(FifthNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearest([PC]),EVILCUTOFF)
Range(FifthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearest([PC]),30)
END

IF
See(SixthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearest([PC]))
CheckStatLT(SixthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SixthNearest([PC]),0,STONESKINS)
!StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SixthNearest([PC]),STATE_DISABLED)
!CheckStatGT(SixthNearest([PC]),0,HELD)
!StateCheck(SixthNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearest([PC]),EVILCUTOFF)
Range(SixthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearest([PC]),30)
END

IF
ActionListEmpty()
See([PC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
!StateCheck([PC],STATE_MIRRORIMAGE)
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject([PC])
END

IF
ActionListEmpty()
See(SecondNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
!StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(SecondNearest([PC]))
END

IF
ActionListEmpty()
See(ThirdNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
!StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(ThirdNearest([PC]))
END

IF
ActionListEmpty()
See(FourthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearest([PC]))
CheckStatLT(FourthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(FourthNearest([PC]),0,STONESKINS)
!StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(FourthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FourthNearest([PC]),0,HELD)
!StateCheck(FourthNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(FourthNearest([PC]))
END

IF
ActionListEmpty()
See(FifthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearest([PC]))
CheckStatLT(FifthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(FifthNearest([PC]),0,STONESKINS)
!StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(FifthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FifthNearest([PC]),0,HELD)
!StateCheck(FifthNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(FifthNearest([PC]))
END

IF
ActionListEmpty()
See(SixthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearest([PC]))
CheckStatLT(SixthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SixthNearest([PC]),0,STONESKINS)
!StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
!StateCheck(SixthNearest([PC]),STATE_DISABLED)
!CheckStatGT(SixthNearest([PC]),0,HELD)
!StateCheck(SixthNearest([PC]),STATE_STONE_DEATH)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(SixthNearest([PC]))
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
Range([PC],5)
THEN
RESPONSE #100
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
Range(SecondNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
Range(ThirdNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
See(FourthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearest([PC]))
!StateCheck(FourthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FourthNearest([PC]),0,HELD)
!StateCheck(FourthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(FourthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(FourthNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearest([PC]),EVILCUTOFF)
Range(FourthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearest([PC]),30)
END

IF
See(FifthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearest([PC]))
!StateCheck(FifthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FifthNearest([PC]),0,HELD)
!StateCheck(FifthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(FifthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(FifthNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearest([PC]),EVILCUTOFF)
Range(FifthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearest([PC]),30)
END

IF
See(SixthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearest([PC]))
!StateCheck(SixthNearest([PC]),STATE_DISABLED)
!CheckStatGT(SixthNearest([PC]),0,HELD)
!StateCheck(SixthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(SixthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SixthNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearest([PC]),EVILCUTOFF)
Range(SixthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearest([PC]),30)
END

IF
ActionListEmpty()
See([PC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
CheckStatLT([PC],50,RESISTSLASHING)
!CheckStatGT([PC],0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject([PC])
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(SecondNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SecondNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(SecondNearest([PC]))
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(ThirdNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(ThirdNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(ThirdNearest([PC]))
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(FourthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearest([PC]))
!StateCheck(FourthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FourthNearest([PC]),0,HELD)
!StateCheck(FourthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(FourthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(FourthNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(FourthNearest([PC]))
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(FifthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearest([PC]))
!StateCheck(FifthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FifthNearest([PC]),0,HELD)
!StateCheck(FifthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(FifthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(FifthNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(FifthNearest([PC]))
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(SixthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearest([PC]))
!StateCheck(SixthNearest([PC]),STATE_DISABLED)
!CheckStatGT(SixthNearest([PC]),0,HELD)
!StateCheck(SixthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(SixthNearest([PC]),50,RESISTSLASHING)
!CheckStatGT(SixthNearest([PC]),0,STONESKINS)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(SixthNearest([PC]))
RESPONSE #50
Continue()
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
CheckStatLT([PC],50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
Range([PC],5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
Range(SecondNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
Range(ThirdNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
See(FourthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearest([PC]))
!StateCheck(FourthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FourthNearest([PC]),0,HELD)
!StateCheck(FourthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(FourthNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearest([PC]),EVILCUTOFF)
Range(FourthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearest([PC]),30)
END

IF
See(FifthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearest([PC]))
!StateCheck(FifthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FifthNearest([PC]),0,HELD)
!StateCheck(FifthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(FifthNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearest([PC]),EVILCUTOFF)
Range(FifthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearest([PC]),30)
END

IF
See(SixthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearest([PC]))
!StateCheck(SixthNearest([PC]),STATE_DISABLED)
!CheckStatGT(SixthNearest([PC]),0,HELD)
!StateCheck(SixthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(SixthNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearest([PC]),EVILCUTOFF)
Range(SixthNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearest([PC]),30)
END

IF
ActionListEmpty()
See([PC])
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
CheckStatLT([PC],50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject([PC])
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(SecondNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(SecondNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(SecondNearest([PC]))
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(ThirdNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(ThirdNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(ThirdNearest([PC]))
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(FourthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearest([PC]))
!StateCheck(FourthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FourthNearest([PC]),0,HELD)
!StateCheck(FourthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(FourthNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(FourthNearest([PC]))
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(FifthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearest([PC]))
!StateCheck(FifthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FifthNearest([PC]),0,HELD)
!StateCheck(FifthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(FifthNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(FifthNearest([PC]))
RESPONSE #50
Continue()
END

IF
ActionListEmpty()
See(SixthNearest([PC]))
!InWeaponRange(LastSeenBy(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearest([PC]))
!StateCheck(SixthNearest([PC]),STATE_DISABLED)
!CheckStatGT(SixthNearest([PC]),0,HELD)
!StateCheck(SixthNearest([PC]),STATE_STONE_DEATH)
CheckStatLT(SixthNearest([PC]),50,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearest([PC]),EVILCUTOFF)
THEN
RESPONSE #100
MoveToObject(SixthNearest([PC]))
RESPONSE #50
Continue()
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
!CheckStatGT([PC],75,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(SecondNearest([PC]),75,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearest([PC]),75,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
See(FourthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearest([PC]))
!StateCheck(FourthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FourthNearest([PC]),0,HELD)
!StateCheck(FourthNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(FourthNearest([PC]),75,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearest([PC]),30)
END

IF
See(FifthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearest([PC]))
!StateCheck(FifthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FifthNearest([PC]),0,HELD)
!StateCheck(FifthNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(FifthNearest([PC]),75,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearest([PC]),30)
END

IF
See(SixthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearest([PC]))
!StateCheck(SixthNearest([PC]),STATE_DISABLED)
!CheckStatGT(SixthNearest([PC]),0,HELD)
!StateCheck(SixthNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(SixthNearest([PC]),75,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearest([PC]),30)
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
!StateCheck([PC],STATE_DISABLED)
!CheckStatGT([PC],0,HELD)
!StateCheck([PC],STATE_STONE_DEATH)
!CheckStatGT([PC],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
!StateCheck(SecondNearest([PC]),STATE_DISABLED)
!CheckStatGT(SecondNearest([PC]),0,HELD)
!StateCheck(SecondNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(SecondNearest([PC]),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
!StateCheck(ThirdNearest([PC]),STATE_DISABLED)
!CheckStatGT(ThirdNearest([PC]),0,HELD)
!StateCheck(ThirdNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearest([PC]),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
See(FourthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearest([PC]))
!StateCheck(FourthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FourthNearest([PC]),0,HELD)
!StateCheck(FourthNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(FourthNearest([PC]),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearest([PC]),30)
END

IF
See(FifthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearest([PC]))
!StateCheck(FifthNearest([PC]),STATE_DISABLED)
!CheckStatGT(FifthNearest([PC]),0,HELD)
!StateCheck(FifthNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(FifthNearest([PC]),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearest([PC]),30)
END

IF
See(SixthNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearest([PC]))
!StateCheck(SixthNearest([PC]),STATE_DISABLED)
!CheckStatGT(SixthNearest([PC]),0,HELD)
!StateCheck(SixthNearest([PC]),STATE_STONE_DEATH)
!CheckStatGT(SixthNearest([PC]),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearest([PC]),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearest([PC]),30)
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(NearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(NearestEnemyOf(Myself),15)
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearestEnemyOf(Myself),15)
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearestEnemyOf(Myself),15)
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearestEnemyOf(Myself),15)
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearestEnemyOf(Myself),15)
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearestEnemyOf(Myself),15)
END

IF
See([PC.0.0.MAGE])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE])
!CheckStatGT([PC.0.0.MAGE],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE],EVILCUTOFF)
ActionListEmpty()
Range([PC.0.0.MAGE],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_THIEF])
!CheckStatGT([PC.0.0.MAGE_THIEF],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_THIEF],EVILCUTOFF)
ActionListEmpty()
Range([PC.0.0.MAGE_THIEF],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE_THIEF],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.MAGE_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.MAGE_ALL])
!CheckStatGT([PC.0.0.MAGE_ALL],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.MAGE_ALL],EVILCUTOFF)
ActionListEmpty()
Range([PC.0.0.MAGE_ALL],5)
THEN
RESPONSE #75
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.MAGE_ALL],30)
RESPONSE #25
Continue()
END

IF
See([PC.0.0.THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF])
!CheckStatGT([PC.0.0.THIEF],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF],EVILCUTOFF)
ActionListEmpty()
Range([PC.0.0.THIEF],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.THIEF],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.BARD_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.BARD_ALL])
!CheckStatGT([PC.0.0.BARD_ALL],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.BARD_ALL],EVILCUTOFF)
ActionListEmpty()
Range([PC.0.0.BARD_ALL],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.BARD_ALL],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.THIEF_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.THIEF_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.THIEF_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.THIEF_ALL])
!CheckStatGT([PC.0.0.THIEF_ALL],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.THIEF_ALL],EVILCUTOFF)
ActionListEmpty()
Range([PC.0.0.THIEF_ALL],5)
THEN
RESPONSE #65
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.THIEF_ALL],30)
RESPONSE #35
Continue()
END

IF
See([PC.0.0.DRUID])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.DRUID],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.DRUID],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.DRUID])
!CheckStatGT([PC.0.0.DRUID],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.DRUID],EVILCUTOFF)
ActionListEmpty()
Range([PC.0.0.DRUID],5)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.DRUID],30)
RESPONSE #30
Continue()
END

IF
See([PC.0.0.CLERIC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC.0.0.CLERIC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC.0.0.CLERIC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC.0.0.CLERIC])
!CheckStatGT([PC.0.0.CLERIC],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC.0.0.CLERIC],EVILCUTOFF)
ActionListEmpty()
Range([PC.0.0.CLERIC],5)
THEN
RESPONSE #70
EquipMostDamagingMelee()
AttackReevaluate([PC.0.0.CLERIC],30)
RESPONSE #30
Continue()
END

IF
See([PC])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([PC],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([PC],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([PC],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([PC],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[PC])
!CheckStatGT([PC],99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance([PC],EVILCUTOFF)
ActionListEmpty()
Range([PC],5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate([PC],30)
END

IF
See(SecondNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([PC]))
!CheckStatGT(SecondNearest([PC]),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearest([PC]),EVILCUTOFF)
ActionListEmpty()
Range(SecondNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearest([PC]),30)
END

IF
See(ThirdNearest([PC]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([PC]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([PC]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([PC]))
!CheckStatGT(ThirdNearest([PC]),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearest([PC]),EVILCUTOFF)
ActionListEmpty()
Range(ThirdNearest([PC]),5)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearest([PC]),30)
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(NearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(NearestEnemyOf(Myself),15)
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SecondNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SecondNearestEnemyOf(Myself),15)
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(ThirdNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(ThirdNearestEnemyOf(Myself),15)
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FourthNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FourthNearestEnemyOf(Myself),15)
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(FifthNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(FifthNearestEnemyOf(Myself),15)
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
Allegiance(Myself,ENEMY)
!Allegiance(SixthNearestEnemyOf(Myself),EVILCUTOFF)
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(SixthNearestEnemyOf(Myself),15)
END

IF
OR(2)
See([EVILCUTOFF.0.147.193]) // Djinn
See([EVILCUTOFF.0.147.196]) // Noble Djinn
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastSeenBy(Myself),30)
END

IF
Global("RR#NOPND","GLOBAL",0) // opening doors is allowed
Allegiance(Myself,EVILCUTOFF) // humanoids and some intelligent monsters can open unlocked doors
!AreaType(OUTDOOR)
!Range(NearestEnemyOf(Myself),30)
Range(NearestDoor,15) // if the nearest door is in visual range. note: this seems to auto-skip locked doors
OpenState(NearestDoor,FALSE)
THEN
RESPONSE #100
MoveToObject(NearestDoor)
OpenDoor(NearestDoor)
END

IF
See(NearestEnemyOf(Myself))
ActionListEmpty()
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(NearestEnemyOf(Myself),15)
END

IF
See(LastAttackerOf(Myself))
ActionListEmpty()
!Allegiance(Myself,ENEMY)
AttackedBy([ANYONE],DEFAULT)
THEN
RESPONSE #100
EquipMostDamagingMelee()
AttackReevaluate(LastAttackerOf(Myself),15)
END

IF
!GlobalTimerNotExpired("RR#Move","LOCALS") // help -> move timer
OR(6)
Heard([EVILCUTOFF.0.147.194],89) // Dao
Heard([EVILCUTOFF.0.147.195],89) // Efreeti
Heard([EVILCUTOFF.0.147.197],89) // Noble Efreeti
Heard([EVILCUTOFF.0.145.187],89) // Elemental of Fire and Salamander
Heard([EVILCUTOFF.0.145.187],151)// Elemental of Fire and Salamander
Heard([EVILCUTOFF.0.105],89) 	 // Hell Hounds
InMyArea(LastHeardBy(Myself))
!StateCheck(LastHeardBy(Myself),STATE_REALLY_DEAD)
THEN
RESPONSE #100
SetGlobalTimer("RR#Move","LOCALS",6)
MoveToObject(LastHeardBy(Myself))
END

IF
    Allegiance(Myself,EVILCUTOFF) // only RandomWalk if hostile
	!GlobalTimerNotExpired("RR#Move","LOCALS")
	!Detect(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		RandomWalkContinuous()
END